<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="bitcamp.java77.dao.WishDao">

	<resultMap type="wish" id="wishMap">
		<id 	column="wno" 		property="no"/>
		<result column="FPATH" 		property="path"/>
		<result column="CONT" 	property="content"/>
	</resultMap>
	
	<select id="selectList" resultMap="wishMap" parameterType="map">
		select wno, fpath, title, cont, price, url, buy, tag, date, cno, uno
		from wish
		where uno=#{uno}
		order by 
		<choose>
		 <when test="keyword == 'title'">title </when>
		 <when test="keyword == 'price'">price </when>
		 <otherwise>wno desc</otherwise>
		</choose>
		limit #{startIndex}, #{length}
	</select>
  
	<select id="selectNo" resultType="int">
		select max(wno) from wish
	</select>
	
	<!-- 유저의 디폴트카테고리 번호 반환 -->
	<select id="selectcNo" resultType="int">
		select min(cno) from category where uno=#{uno}
	</select>
	
	<select id="selectOne" resultMap="wishMap" parameterType="int">
		select wno, fpath, title, cont, price, url, buy, tag, date, cno from wish where wno=#{no}
	</select>
   
	<insert id="insert" parameterType="wish">
		insert into wish(fpath, title, cont, price, url, tag, cno, uno) 
		values(#{path}, #{title}, #{content}, #{price}, #{url}, #{tag}, #{cno}, #{uno})
	</insert>
  
	<delete id="delete" parameterType="map">
		delete from wish where wno=#{no}
	</delete>
  
	<update id="update" parameterType="wish">
		update wish 
		set fpath=#{path}, title=#{title}, cont=#{content}, price=#{price}, url=#{url}, tag=#{tag}, date=now()  	  
	    where wno=#{no}
	</update>
	
	<update id="updateBuy" parameterType="wish">
		update wish 
		set buy=#{buy}
	    where wno=#{no}
	</update>
  
</mapper>






