<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="bitcamp.java77.dao.CategoryDao">

<insert id="addCategory" parameterType="category">
	insert into CATEGORY(NAME,uno) 
		values(#{name},#{uNo})
</insert>

<select id="categoryList" resultType="category" parameterType="category">
	select category.cno, category.name, category.uno , wish.*, (select wish.fpath 
															  from wish
															 where cno=1
															 ORDER BY RAND()
															 LIMIT 1) as path1, (select wish.fpath 
															  from wish
															 where cno=1
															 ORDER BY RAND()
															 LIMIT 1) as path2,
															 (select wish.fpath 
															  from wish
															 where cno=1
															 ORDER BY RAND()
															 LIMIT 1) as path3,
															 (select wish.fpath 
															  from wish
															 where cno=1
															 ORDER BY RAND()
															 LIMIT 1) as path4
	  from category, wish
	 where category.uno=#{uno} and wish.uno=#{uno}
	 group by category.cno
</select>

	<!-- 카테고리 수정하기 -->
	<update id="updateCategory" parameterType="category">
		update category 
		   set name=#{name}
	     where cno=#{cno}
	</update>
	
	<!-- 카테고리 삭제하기 -->
	<delete id="deleteCategory">
		delete
		  from category
		 where cno=#{cno}
	</delete>


</mapper>